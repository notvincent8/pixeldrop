@import "tailwindcss";

@layer base {
    :root {
        --color-common: #a8b5b2;
        --color-uncommon: #4ade80;
        --color-rare: #60a5fa;
        --color-epic: #c084fc;
        --color-legendary: #fbbf24;
        --color-mythic: #ff3c6f;

        --color-common-glow: #a8b5b240;
        --color-uncommon-glow: #4ade8050;
        --color-rare-glow: #60a5fa50;
        --color-epic-glow: #c084fc50;
        --color-legendary-glow: #fbbf2460;
        --color-mythic-glow: #ff3c6f70;

        --font-pixel: 'Press Start 2P', monospace;
        --font-display: 'Silkscreen', monospace;
        --font-mono: 'VT323', monospace;

        --bg-dark: #0a0a12;
        --bg-panel: #12121e;
        --bg-panel-hover: #1a1a2e;
        --border-dim: #2a2a4a;
        --border-glow: #4a4a8a;
    }

    * {
        image-rendering: pixelated;
    }

    html, body {
        background: var(--bg-dark);
        font-family: var(--font-mono);
    }

    button {
        cursor: pointer;
    }
}

@layer components {
    .scanlines {
        pointer-events: none;
        position: fixed;
        inset: 0;
        z-index: 9999;
        background: repeating-linear-gradient(
            0deg,
            transparent,
            transparent 2px,
            rgba(0, 0, 0, 0.08) 2px,
            rgba(0, 0, 0, 0.08) 4px
        );
    }

    .pixel-border {
        border: 3px solid var(--border-dim);
        box-shadow:
            inset 0 0 0 1px var(--bg-dark),
            0 0 0 1px var(--bg-dark);
    }

    .pixel-border-glow {
        border: 3px solid var(--border-glow);
        box-shadow:
            inset 0 0 0 1px var(--bg-dark),
            0 0 12px rgba(74, 74, 138, 0.3),
            0 0 0 1px var(--bg-dark);
    }

    .rarity-common { color: var(--color-common); }
    .rarity-uncommon { color: var(--color-uncommon); }
    .rarity-rare { color: var(--color-rare); }
    .rarity-epic { color: var(--color-epic); }
    .rarity-legendary { color: var(--color-legendary); }
    .rarity-mythic { color: var(--color-mythic); }

    .glow-common { text-shadow: 0 0 6px var(--color-common-glow); }
    .glow-uncommon { text-shadow: 0 0 8px var(--color-uncommon-glow); }
    .glow-rare { text-shadow: 0 0 10px var(--color-rare-glow); }
    .glow-epic { text-shadow: 0 0 12px var(--color-epic-glow); }
    .glow-legendary { text-shadow: 0 0 16px var(--color-legendary-glow), 0 0 32px var(--color-legendary-glow); }
    .glow-mythic {
        text-shadow: 0 0 16px var(--color-mythic-glow), 0 0 32px var(--color-mythic-glow);
        animation: mythic-pulse 2s ease-in-out infinite;
    }

    .chest-icon {
        width: 64px;
        height: 52px;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .chest-body {
        width: 56px;
        height: 36px;
        background: linear-gradient(180deg, #8b6914 0%, #6b4e0a 40%, #4a3506 100%);
        border: 3px solid #3d2b04;
        border-radius: 2px 2px 4px 4px;
        position: absolute;
        bottom: 0;
        box-shadow: inset 0 -4px 0 rgba(0,0,0,0.3), inset 0 2px 0 rgba(255,200,50,0.15);
    }

    .chest-lid {
        width: 60px;
        height: 20px;
        background: linear-gradient(180deg, #b8860b 0%, #8b6914 100%);
        border: 3px solid #3d2b04;
        border-radius: 4px 4px 0 0;
        position: absolute;
        top: 0;
        box-shadow: inset 0 2px 0 rgba(255,215,0,0.3);
        transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        transform-origin: bottom center;
    }

    .chest-lock {
        width: 10px;
        height: 12px;
        background: #daa520;
        border: 2px solid #8b6914;
        border-radius: 2px;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 2;
        box-shadow: 0 0 4px rgba(218,165,32,0.4);
    }

    .chest-lock::before {
        content: '';
        width: 6px;
        height: 6px;
        border: 2px solid #8b6914;
        border-radius: 50%;
        position: absolute;
        top: -7px;
        left: 50%;
        transform: translateX(-50%);
        background: transparent;
    }

    button:hover .chest-lid {
        transform: rotateX(-20deg) translateY(-2px);
    }

    button:active .chest-lid {
        transform: rotateX(-35deg) translateY(-4px);
    }

    .chest-rare .chest-body {
        background: linear-gradient(180deg, #2563eb 0%, #1d4ed8 40%, #1e3a8a 100%);
        border-color: #1e3a8a;
        box-shadow: inset 0 -4px 0 rgba(0,0,0,0.3), inset 0 2px 0 rgba(96,165,250,0.2), 0 0 20px rgba(96,165,250,0.3);
    }

    .chest-rare .chest-lid {
        background: linear-gradient(180deg, #3b82f6 0%, #2563eb 100%);
        border-color: #1e3a8a;
        box-shadow: inset 0 2px 0 rgba(147,197,253,0.3), 0 0 12px rgba(96,165,250,0.4);
    }

    .chest-rare .chest-lock {
        background: #93c5fd;
        border-color: #2563eb;
        box-shadow: 0 0 8px rgba(96,165,250,0.6);
    }

    .chest-epic .chest-body {
        background: linear-gradient(180deg, #7c3aed 0%, #6d28d9 40%, #4c1d95 100%);
        border-color: #4c1d95;
        box-shadow: inset 0 -4px 0 rgba(0,0,0,0.3), inset 0 2px 0 rgba(192,132,252,0.2), 0 0 24px rgba(192,132,252,0.3);
    }

    .chest-epic .chest-lid {
        background: linear-gradient(180deg, #8b5cf6 0%, #7c3aed 100%);
        border-color: #4c1d95;
        box-shadow: inset 0 2px 0 rgba(196,181,253,0.3), 0 0 16px rgba(192,132,252,0.4);
    }

    .chest-epic .chest-lock {
        background: #c4b5fd;
        border-color: #7c3aed;
        box-shadow: 0 0 10px rgba(192,132,252,0.6);
    }

    .chest-shake {
        animation: chest-shake var(--shake-duration, 0.6s) cubic-bezier(0.36, 0.07, 0.19, 0.97) forwards;
    }

    @keyframes chest-shake {
        0%, 100% { transform: translateX(0); }
        10% { transform: translateX(calc(-1px * var(--shake-intensity, 2))); }
        20% { transform: translateX(calc(1px * var(--shake-intensity, 2))); }
        30% { transform: translateX(calc(-1px * var(--shake-intensity, 2))); }
        40% { transform: translateX(calc(1.5px * var(--shake-intensity, 2))); }
        50% { transform: translateX(calc(-1.5px * var(--shake-intensity, 2))); }
        60% { transform: translateX(calc(1px * var(--shake-intensity, 2))); }
        70% { transform: translateX(calc(-1.5px * var(--shake-intensity, 2))); }
        80% { transform: translateX(calc(1px * var(--shake-intensity, 2))); }
        90% { transform: translateX(calc(-0.5px * var(--shake-intensity, 2))); }
    }

    .chest-aura {
        position: absolute;
        inset: -8px;
        border-radius: 6px;
        pointer-events: none;
        opacity: 0;
        transition: opacity 0.5s ease, box-shadow 0.5s ease;
    }

    .chest-aura.active {
        opacity: 1;
        animation: aura-breathe 3s ease-in-out infinite;
    }

    @keyframes aura-breathe {
        0%, 100% { opacity: 0.6; }
        50% { opacity: 1; }
    }

    .drop-item {
        opacity: 0;
        animation: drop-in 0.5s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    }

    .drop-item-rare {
        font-size: 15px !important;
        padding: 8px 14px !important;
        box-shadow: 0 0 12px var(--color-rare-glow), inset 0 0 8px rgba(96, 165, 250, 0.1);
    }

    .drop-item-epic {
        font-size: 16px !important;
        padding: 9px 16px !important;
        box-shadow: 0 0 16px var(--color-epic-glow), inset 0 0 10px rgba(192, 132, 252, 0.1);
    }

    .drop-item-legendary {
        font-size: 17px !important;
        padding: 10px 18px !important;
        box-shadow: 0 0 20px var(--color-legendary-glow), 0 0 40px var(--color-legendary-glow), inset 0 0 12px rgba(251, 191, 36, 0.1);
        animation: drop-in 0.5s cubic-bezier(0.22, 1, 0.36, 1) forwards, legendary-glow-border 2s ease-in-out infinite 0.5s;
    }

    .drop-item-mythic {
        font-size: 18px !important;
        padding: 11px 20px !important;
        box-shadow: 0 0 24px var(--color-mythic-glow), 0 0 48px var(--color-mythic-glow), inset 0 0 14px rgba(255, 60, 111, 0.15);
        animation: drop-in 0.5s cubic-bezier(0.22, 1, 0.36, 1) forwards, mythic-glow-border 1.5s ease-in-out infinite 0.5s;
    }

    @keyframes legendary-glow-border {
        0%, 100% {
            box-shadow: 0 0 20px var(--color-legendary-glow), 0 0 40px var(--color-legendary-glow), inset 0 0 12px rgba(251, 191, 36, 0.1);
        }
        50% {
            box-shadow: 0 0 28px var(--color-legendary-glow), 0 0 56px var(--color-legendary-glow), inset 0 0 16px rgba(251, 191, 36, 0.15);
        }
    }

    @keyframes mythic-glow-border {
        0%, 100% {
            box-shadow: 0 0 24px var(--color-mythic-glow), 0 0 48px var(--color-mythic-glow), inset 0 0 14px rgba(255, 60, 111, 0.15);
        }
        50% {
            box-shadow: 0 0 36px var(--color-mythic-glow), 0 0 64px var(--color-mythic-glow), inset 0 0 20px rgba(255, 60, 111, 0.2);
        }
    }

    .drop-item-best {
        animation: drop-in-best 0.8s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    }

    @keyframes drop-in-best {
        0% {
            opacity: 0;
            transform: translateY(-24px) scale(0.4);
            filter: brightness(4);
        }
        50% {
            opacity: 1;
            transform: translateY(0) scale(1.2);
            filter: brightness(1.6);
        }
        75% {
            transform: translateY(-2px) scale(1.15);
            filter: brightness(1.2);
        }
        100% {
            opacity: 1;
            transform: translateY(0) scale(1.05);
            filter: brightness(1);
        }
    }

    .particle-container {
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        pointer-events: none;
        z-index: 20;
    }

    .particle {
        position: absolute;
        width: 4px;
        height: 4px;
        transform: translate(-50%, -50%);
        animation: particle-burst var(--p-duration, 1s) cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
        opacity: 0;
    }

    .particle-diamond {
        clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
    }

    .particle-square {
        clip-path: polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%);
    }

    .particle-star {
        clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
        width: 6px;
        height: 6px;
    }

    @keyframes particle-burst {
        0% {
            opacity: 1;
            transform: translate(-50%, -50%) translate(0, 0) scale(1);
        }
        30% {
            opacity: 1;
        }
        100% {
            opacity: 0;
            transform: translate(-50%, -50%) translate(var(--p-x), var(--p-y)) scale(0.3);
        }
    }

    .rarity-announce {
        animation: announce-in 0.6s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    }

    @keyframes announce-in {
        0% {
            opacity: 0;
            transform: scale(0.5) translateY(20px);
            filter: brightness(3);
        }
        60% {
            opacity: 1;
            transform: scale(1.15) translateY(-5px);
            filter: brightness(1.3);
        }
        100% {
            opacity: 1;
            transform: scale(1) translateY(0);
            filter: brightness(1);
        }
    }

    .observed-sidebar {
        position: fixed;
        top: 50%;
        right: 16px;
        transform: translateY(-50%);
        z-index: 50;
        width: 260px;
        max-height: calc(100vh - 32px);
        transition: transform 0.3s cubic-bezier(0.22, 1, 0.36, 1), opacity 0.3s ease;
    }

    .observed-sidebar.collapsed {
        transform: translateY(-50%) translateX(calc(100% - 36px));
    }

    .sidebar-toggle {
        position: absolute;
        top: 8px;
        left: -28px;
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--bg-panel);
        border: 2px solid var(--border-dim);
        font-size: 12px;
        color: var(--border-glow);
        cursor: pointer;
        transition: border-color 0.2s;
    }

    .sidebar-toggle:hover {
        border-color: var(--border-glow);
    }

    .debug-panel {
        position: fixed;
        top: 16px;
        left: 16px;
        z-index: 200;
        background: rgba(10, 10, 18, 0.95);
        border: 2px solid #ff4444;
        padding: 12px;
        min-width: 220px;
        backdrop-filter: blur(4px);
    }

    .debug-panel h4 {
        font-family: var(--font-pixel);
        font-size: 8px;
        color: #ff4444;
        margin-bottom: 10px;
        letter-spacing: 0.15em;
    }

    .debug-btn {
        display: block;
        width: 100%;
        padding: 6px 8px;
        margin-bottom: 4px;
        background: rgba(255, 68, 68, 0.1);
        border: 1px solid rgba(255, 68, 68, 0.3);
        color: #ff8888;
        font-family: var(--font-display);
        font-size: 14px;
        text-align: left;
        cursor: pointer;
        transition: background 0.15s, border-color 0.15s;
    }

    .debug-btn:hover {
        background: rgba(255, 68, 68, 0.2);
        border-color: rgba(255, 68, 68, 0.6);
    }

    .debug-btn.active {
        background: rgba(255, 68, 68, 0.3);
        border-color: #ff4444;
        color: #ffffff;
    }

    .event-banner {
        position: fixed;
        top: 12px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 60;
        padding: 6px 16px;
        background: var(--bg-panel);
        border: 2px solid;
        font-family: var(--font-pixel);
        font-size: 8px;
        letter-spacing: 0.1em;
        animation: banner-pulse 2s ease-in-out infinite;
    }

    @keyframes banner-pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.75; }
    }

    .streak-counters {
        display: flex;
        gap: 12px;
        font-family: var(--font-mono);
        font-size: 18px;
        color: var(--border-dim);
        transition: color 0.3s ease;
    }

    .streak-hot {
        color: var(--color-legendary);
        text-shadow: 0 0 8px var(--color-legendary-glow);
    }

    @keyframes mythic-pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.7; }
    }

    @keyframes chest-bounce {
        0% { transform: translateY(0) scale(1); }
        12% { transform: translateY(-12px) scale(1.08); }
        28% { transform: translateY(0) scale(0.95); }
        42% { transform: translateY(-6px) scale(1.04); }
        58% { transform: translateY(0) scale(0.98); }
        72% { transform: translateY(-2px) scale(1.01); }
        100% { transform: translateY(0) scale(1); }
    }

    @keyframes drop-in {
        0% {
            opacity: 0;
            transform: translateY(-20px) scale(0.5);
            filter: brightness(3);
        }
        60% {
            opacity: 1;
            transform: translateY(2px) scale(1.1);
            filter: brightness(1.5);
        }
        100% {
            opacity: 1;
            transform: translateY(0) scale(1);
            filter: brightness(1);
        }
    }

    @keyframes flicker {
        0%, 100% { opacity: 1; }
        92% { opacity: 1; }
        93% { opacity: 0.8; }
        94% { opacity: 1; }
        96% { opacity: 0.9; }
        97% { opacity: 1; }
    }

    @keyframes float {
        0%, 100% { transform: translateY(0px); }
        50% { transform: translateY(-4px); }
    }

    @keyframes shimmer {
        0% { background-position: -200% 0; }
        100% { background-position: 200% 0; }
    }

    .chest-bounce {
        animation: chest-bounce 0.9s cubic-bezier(0.36, 0, 0.66, -0.56);
    }

    .title-flash {
        animation: title-pulse 0.4s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    }

    @keyframes title-pulse {
        0% {
            filter: brightness(1);
            transform: scale(1);
        }
        30% {
            filter: brightness(2.5);
            transform: scale(1.08);
        }
        60% {
            filter: brightness(1.4);
            transform: scale(1.02);
        }
        100% {
            filter: brightness(1);
            transform: scale(1);
        }
    }

    .flicker {
        animation: flicker 4s linear infinite;
    }

    .float {
        animation: float 3s ease-in-out infinite;
    }

    .xp-bar {
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
        background-size: 200% 100%;
        animation: shimmer 3s linear infinite;
    }
}
